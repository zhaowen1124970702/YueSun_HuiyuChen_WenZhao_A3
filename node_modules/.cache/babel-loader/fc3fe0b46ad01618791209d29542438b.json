{"ast":null,"code":"var _jsxFileName = \"/Users/huiyuchen/YueSun_HuiyuChen_WenZhao_A3/src/Component/Post.js\";\nimport React from 'react';\nimport Comment from './Comment';\nimport Axios from 'axios';\nimport Navbar from './Navbar';\nimport \"./Post.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class Post extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      idForQuery: props.query,\n      loginUser: null,\n      currentPost: null,\n      allComments: [],\n      newComment: \"\",\n      editing: false,\n      message: \"\",\n      title: \"\",\n      URL: \"\",\n      content: \"\"\n    };\n  }\n\n  getParams(location) {\n    const searchParams = new URLSearchParams(location.search);\n    return {\n      query: searchParams.get(\"query\") || \"\"\n    };\n  }\n\n  componentWillMount() {\n    Axios.get('/api/post/' + this.state.idForQuery).then(response => {\n      if (!response.data._id) {\n        window.location.href = \"/\";\n      }\n    }).catch(error => console.error(error));\n  }\n\n  componentDidMount() {\n    Axios.get('/api/login/cookie').then(response => {\n      this.setState({\n        loginUser: response.data\n      });\n    }).catch(error => {\n      this.setState({\n        loginUser: null\n      });\n    });\n    Axios.get('/api/post/' + this.state.idForQuery).then(response => {\n      this.setState({\n        currentPost: response.data,\n        title: response.data.title,\n        username: response.data.username,\n        URL: response.data.URL,\n        content: response.data.content\n      });\n    }).catch(error => console.error(error));\n    Axios.get('/api/comment/' + this.state.idForQuery).then(response => {\n      this.setState({\n        allComments: response.data\n      });\n    }).catch(error => {\n      console.error(error);\n      this.setState({\n        allComments: []\n      });\n    });\n  }\n\n  componentDidUpdate() {}\n\n  submitDelete() {\n    Axios.delete('/api/post/' + this.state.currentPost._id).catch(error => {\n      this.setState({\n        message: \"Fail to delete post\"\n      });\n    });\n    Axios.delete('/api/comment/' + this.state.currentPost._id).then(response => {\n      window.location.href = \"/\";\n    }).catch(error => {\n      this.setState({\n        message: \"Fail to delete all comments\"\n      });\n    });\n  }\n\n  showEditandDelete() {\n    if (this.state.loginUser === this.state.currentPost.username) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"editDeleyeDetail\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"editStyle\",\n          onClick: () => this.changeToEditingMode(),\n          children: \"Edit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"deleteStyle\",\n          onClick: () => this.submitDelete(),\n          children: \"Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this);\n    }\n  }\n\n  jump2Post() {\n    if (this.state.URL) {\n      window.location.href = this.state.URL;\n    }\n  }\n\n  showPost() {\n    if (!this.state.editing) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"titleStyle\",\n          children: [\"Title: \", this.state.currentPost.title]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"postInforStyle\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"editorStyle\",\n            children: this.state.currentPost.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"timeStyle\",\n            children: this.state.currentPost.postTime.slice(0, 10) + \" \" + this.state.currentPost.postTime.slice(11, 19)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"timeStyle\",\n            children: [this.state.allComments.length, \" comments\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: this.showEditandDelete()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"titleStyle\",\n          children: \"URL:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"URLStyle\",\n          onClick: () => this.jump2Post(),\n          children: this.state.currentPost.URL\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"titleStyle\",\n          children: \"OR\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"titleStyle\",\n          children: \"Content:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"inputStyle2\",\n          children: this.state.currentPost.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 21\n        }, this), this.displayErrorMessage(), this.showAddSubmit(), this.showComments()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 17\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"titleStyle\",\n          children: \"Title:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"postInforStyle2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"editorStyle\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 25\n          }, this), this.state.currentPost.username, /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"timeStyle\",\n            children: [\" \", this.state.currentPost.postTime.slice(0, 10) + \" \" + this.state.currentPost.postTime.slice(11, 19), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"inputStyle\",\n          type: \"text\",\n          value: this.state.title,\n          onChange: e => this.setState({\n            title: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"titleStyle\",\n          children: \"URL:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"inputStyle\",\n          type: \"text\",\n          value: this.state.URL,\n          onChange: e => this.setState({\n            URL: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"titleStyle\",\n          children: \"OR\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"titleStyle\",\n          children: \"Content:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"contentStyle\",\n          type: \"text\",\n          value: this.state.content,\n          onChange: e => this.setState({\n            content: e.target.value\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"createButton\",\n          onClick: () => this.submitEdit(),\n          children: \"Submit Edit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 21\n        }, this), this.showAddSubmit(), this.displayErrorMessage(), this.showComments()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 17\n      }, this);\n    }\n  }\n\n  submitEdit() {\n    const newPost = {};\n    newPost._id = this.state.currentPost._id;\n    newPost.title = this.state.title;\n    newPost.URL = this.state.URL;\n    newPost.content = this.state.content;\n\n    if (!newPost.content && !newPost.URL || newPost.content && newPost.URL) {\n      this.setState({\n        message: \"Only need URL or Content\"\n      });\n      return;\n    }\n\n    if (!newPost.title) {\n      return this.setState({\n        message: \"Please input title for the new post\"\n      });\n    }\n\n    Axios.put('/api/post', newPost).then(response => {\n      const postID = response.data._id;\n      window.location.href = \"post?id=\" + postID;\n    }).catch(error => {\n      this.setState({\n        message: \"Fail to update Post\"\n      });\n    });\n  }\n\n  changeToEditingMode() {\n    this.setState({\n      editing: true\n    });\n  }\n\n  submitAddNewComment() {\n    const newComment = {\n      editorUsername: this.state.loginUser,\n      postID: this.state.idForQuery,\n      content: this.state.newComment\n    };\n\n    if (this.state.newComment) {\n      Axios.post('/api/comment', newComment).then(response => {\n        window.location.href = \"post?id=\" + this.state.idForQuery;\n      }).catch(error => {\n        this.setState({\n          message: \"Fail to add new comment!  Please try log in / sign up!\"\n        });\n      });\n    }\n  }\n\n  showAddSubmit() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        className: \"inputStyle\",\n        type: \"text\",\n        value: this.state.newComment,\n        onChange: e => this.setState({\n          newComment: e.target.value\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"createButton\",\n        onClick: () => this.submitAddNewComment(),\n        children: \"Add Comments\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 13\n    }, this);\n  }\n\n  displayErrorMessage() {\n    if (this.state.message) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messageStyle\",\n        children: this.state.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 17\n      }, this);\n    }\n  }\n\n  showComments() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: this.state.allComments.reverse().map((singleComment, index) => /*#__PURE__*/_jsxDEV(Comment, {\n        comment: singleComment,\n        loginUser: this.state.loginUser\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 79\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 13\n    }, this);\n  }\n\n  render() {\n    if (!this.state.currentPost) {\n      return null;\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 17\n      }, this), this.showPost()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 13\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/Users/huiyuchen/YueSun_HuiyuChen_WenZhao_A3/src/Component/Post.js"],"names":["React","Comment","Axios","Navbar","Post","Component","constructor","props","state","idForQuery","query","loginUser","currentPost","allComments","newComment","editing","message","title","URL","content","getParams","location","searchParams","URLSearchParams","search","get","componentWillMount","then","response","data","_id","window","href","catch","error","console","componentDidMount","setState","username","componentDidUpdate","submitDelete","delete","showEditandDelete","changeToEditingMode","jump2Post","showPost","postTime","slice","length","displayErrorMessage","showAddSubmit","showComments","e","target","value","submitEdit","newPost","put","postID","submitAddNewComment","editorUsername","post","reverse","map","singleComment","index","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Comment from './Comment';\nimport Axios from 'axios';\nimport Navbar from './Navbar';\nimport \"./Post.css\";\n\n\nexport default class Post extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            idForQuery : props.query,\n            loginUser: null,\n            currentPost : null,\n            allComments : [],\n            newComment : \"\",\n            editing: false,\n            message:\"\",\n            title:\"\",\n            URL:\"\",\n            content:\"\"\n        }\n    }\n\n    getParams(location) {\n        const searchParams = new URLSearchParams(location.search);\n        return {\n          query: searchParams.get(\"query\") || \"\"\n        };\n      }\n\n    \n    componentWillMount(){\n        Axios.get('/api/post/' + this.state.idForQuery)\n            .then((response) => {\n                if(!response.data._id){\n                    window.location.href = \"/\";\n                }\n                })\n            .catch(error => console.error(error));\n\n    }\n\n\n    componentDidMount() {\n        Axios.get('/api/login/cookie')\n            .then((response) => {\n                this.setState({\n                    loginUser: response.data\n                })\n            })\n            .catch((error) => {\n                this.setState({\n                    loginUser: null\n                })\n        })\n\n        Axios.get('/api/post/' + this.state.idForQuery)\n            .then((response) => {\n                this.setState({\n                    currentPost: response.data,\n                    title: response.data.title,\n                    username: response.data.username,\n                    URL: response.data.URL,\n                    content: response.data.content\n            })})\n            .catch(error => console.error(error));\n\n        Axios.get('/api/comment/' + this.state.idForQuery)\n        .then(\n            (response) => {\n                this.setState({\n                    allComments: response.data\n                })})\n        .catch(error => {\n            console.error(error);\n            this.setState({\n                allComments: []\n            })    \n        });\n\n    }\n\n    componentDidUpdate() {\n    }\n\n    \n    submitDelete(){\n        Axios.delete('/api/post/' + this.state.currentPost._id)\n            .catch((error) => {\n                this.setState( {\n                    message: \"Fail to delete post\"\n                })\n            })\n        \n        Axios.delete('/api/comment/' + this.state.currentPost._id)\n            .then((response) => {\n                window.location.href =\"/\";\n            })\n            .catch((error) => {\n                this.setState( {\n                    message: \"Fail to delete all comments\"\n                })\n            })\n        \n    }\n\n    showEditandDelete(){\n        if(this.state.loginUser === this.state.currentPost.username){\n            return(\n                <div className=\"editDeleyeDetail\">\n                    <div className=\"editStyle\" onClick={() => this.changeToEditingMode()}>\n                        Edit\n                    </div>\n                    <div className=\"deleteStyle\" onClick={() => this.submitDelete()}>\n                        Delete\n                    </div>\n                </div>\n            \n            )\n        }\n    }\n\n    jump2Post(){\n        if(this.state.URL){\n            window.location.href = this.state.URL\n        }\n    }\n\n    showPost(){\n        if(!this.state.editing){\n            return(\n                <div className=\"container\">\n                    <div className=\"titleStyle\">Title: {this.state.currentPost.title}</div>\n                    <div className=\"postInforStyle\">\n                        <div className=\"editorStyle\">{this.state.currentPost.username}</div>\n                        <div className=\"timeStyle\">{this.state.currentPost.postTime.slice(0,10) + \" \" + this.state.currentPost.postTime.slice(11,19) }</div>\n                        <div className=\"timeStyle\">{this.state.allComments.length} comments</div>\n                        <div >{this.showEditandDelete()}</div>\n                    </div>\n                    <div className=\"titleStyle\">URL:</div>\n                    <div className=\"URLStyle\" onClick={() => this.jump2Post()}>{this.state.currentPost.URL}</div>\n                    <div className=\"titleStyle\">OR</div>\n                    <div className=\"titleStyle\">Content:</div>\n                    <div className=\"inputStyle2\">{this.state.currentPost.content}</div>\n                    {this.displayErrorMessage()}\n                    {this.showAddSubmit()}\n                    {this.showComments()}\n                </div>\n            )\n        }else{\n            return(\n                <div className=\"container\">\n                    <label className=\"titleStyle\">Title:</label>\n                    <div className=\"postInforStyle2\">\n                        <div className=\"editorStyle\"></div>{this.state.currentPost.username}\n                        <div className=\"timeStyle\"> {this.state.currentPost.postTime.slice(0,10) + \" \" + this.state.currentPost.postTime.slice(11,19) } </div>\n                    </div>\n                    <textarea className=\"inputStyle\" type=\"text\" value={this.state.title} onChange={e => this.setState({title: e.target.value})}></textarea>\n\n                    <label className=\"titleStyle\">URL:</label>\n                    <textarea className=\"inputStyle\" type=\"text\" value={this.state.URL} onChange={e => this.setState({URL: e.target.value})}></textarea>\n                    \n                    <div className=\"titleStyle\">OR</div>\n                    \n                    <label className=\"titleStyle\">Content:</label>\n                    <textarea className=\"contentStyle\" type=\"text\" value={this.state.content} onChange={e => this.setState({content: e.target.value})}></textarea>\n                    \n                    <div className=\"createButton\" onClick={() => this.submitEdit()}>Submit Edit</div>\n                    \n                    {this.showAddSubmit()}\n                    {this.displayErrorMessage()}\n                    {this.showComments()}\n                </div>\n            )\n        }\n    }\n\n    submitEdit(){\n        const newPost ={}\n        newPost._id = this.state.currentPost._id;\n        newPost.title = this.state.title;\n        newPost.URL = this.state.URL;\n        newPost.content = this.state.content;\n\n        if((!newPost.content && !newPost.URL) || (newPost.content && newPost.URL)){\n            this.setState({\n                message: \"Only need URL or Content\"\n            })\n            return\n        }\n\n        if(!newPost.title){\n            return this.setState({\n                message: \"Please input title for the new post\"\n            })\n        }\n\n        Axios.put('/api/post', newPost)\n        .then((response) => {\n            const postID = response.data._id;\n            window.location.href = \"post?id=\" + postID;\n        })\n        .catch((error) => {\n            this.setState( {\n                message: \"Fail to update Post\"\n            })\n        })\n    }\n\n    changeToEditingMode(){\n        this.setState( {\n            editing:true\n        })\n    }\n\n\n    submitAddNewComment(){\n        const newComment = {\n            editorUsername:this.state.loginUser,\n            postID:this.state.idForQuery,\n            content : this.state.newComment\n        }\n        if(this.state.newComment){\n            Axios.post('/api/comment', newComment)\n            .then((response) => {\n                window.location.href = \"post?id=\" + this.state.idForQuery;\n            })\n            .catch((error) => {\n                this.setState( {\n                    message: \"Fail to add new comment!  Please try log in / sign up!\"\n                })\n            })\n        }\n    }\n\n    showAddSubmit(){\n        return(\n            <div >\n                <textarea className=\"inputStyle\" type=\"text\" value={this.state.newComment} onChange={e => this.setState({newComment: e.target.value})}></textarea>\n                <div className=\"createButton\" onClick={() => this.submitAddNewComment()}>Add Comments</div>\n            </div>\n        )\n    }\n\n    displayErrorMessage(){\n        if(this.state.message){\n            return (\n                <div className=\"messageStyle\">{this.state.message}</div>\n            )\n        }  \n    }\n\n    showComments(){\n        return (\n            <div >\n                {this.state.allComments.reverse().map((singleComment, index)=><Comment key ={index} comment ={singleComment} loginUser = {this.state.loginUser}></Comment>)}\n            </div>\n        )\n    }\n\n    render() {\n        if(!this.state.currentPost){\n            return null;\n        }\n        return (\n            <div>\n                <Navbar></Navbar>\n                {this.showPost()}\n            </div>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}